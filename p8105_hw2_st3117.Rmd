---
title: "p8105_hw2_st3117"
author: "Sha Tao"
date: "September 27, 2018"
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(p8105.datasets)
```

## Problem 1 Table Cleaning
```{r}
# import data
transit = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  gather(key = routes_number, value = routes_name, route1:route11) %>% 
  separate(routes_number, into = c("remove1", "routes_number"), sep = 5) %>% 
  filter(!is.na(routes_name)) %>% 
  mutate(
  entry = ifelse(entry == "YES", yes = TRUE, no = FALSE),
  routes_served = paste(routes_number, routes_name, sep = "_")) %>% 
  select(line:station_longitude, routes_served, entry, vending, entrance_type, ada) %>% 
  arrange(line, station_name)

transit


```

The dataset "transit" is a `r ncol(transit)` by `r nrow(transit)` table.\
It contains line, station_name, latitude, longitude, routes_served, entry, vending, entrance_type and ADA compliance.\
I started by importing the dataset and clean the variable names. Then, used gather function doing a wide to long transpose; used separate function getting routes_number by itself; used filter function removing “NA”s in routes_name; used ifelse function converting entry to a logical variable; combined routes_number and routes_served to a single variable routes_served as requested; seleted the variables as requested; and arrange them by line and station_name.\

It is not a tidy dataset since the routes_served encodes both routes_number and routes_served.

## Problem 1_2
```{r}
transit_distinct = distinct(transit, line, station_name)

transit_ada = 
  filter(transit, ada == TRUE) %>% 
  distinct(line, station_name)

  ?distinct

```


```{r}

trash = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                     sheet = "Mr. Trash Wheel", range = readxl::cell_cols("A:N")) %>% 
  janitor::clean_names() %>%
  filter(!is.na(dumpster)) %>% 
  mutate(
    sports_ball = round(sports_balls) %>% 
                  as.integer(sports_balls)
    )
trash

```

```{r}

prec_2016 = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2016 Precipitation", range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = "2016")
                              
prec_2017 = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                     sheet = "2017 Precipitation", range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = "2017") %>% 
  filter(!is.na(total))

precipitation = 
  bind_rows(prec_2016, prec_2017) %>%
  select(year, month, total) %>% 
  mutate(month = month.name[month])

precipitation
  

```


```{r}

brfss = 
  brfss_smart2010 %>% 
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>% 
  separate(locationdesc, into = c("remove2", "location_desc"), sep = 5) %>% 
  select(year, location_abbr = locationabbr, location_desc, response, data_value) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  select(year:location_desc, excellent, very_good, good, fair, poor) %>% 
  mutate(prop_above_good = (excellent + very_good)/(excellent + very_good + good + fair + poor))
  

```


```{r}

```


